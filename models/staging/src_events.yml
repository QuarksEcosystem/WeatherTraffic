version: 2

sources:
    - name: weather_events
      database: TRAFFIC_WEATHER
      schema: weather
      tables:
        - name: US_WEATHER_EVENTS_RAW
          description: Raw weather events data in United States
          columns:
            - name: event_id
              description: This is the identifier of a record
              tests:
                - unique
                - not_null
            - name: type
              description: The type of an event; examples are rain and snow.
              tests:
                - accepted_values:
                    values: ['Severe-Cold', 'Fog', 'Hail', 'Rain', 'Snow', 'Storm', 'Precipitation']
                    config:
                      severity: warn
                - not_null
            - name: severity
              description: The severity of an event, wherever applicable.
              tests:
                - accepted_values:
                    values: ["Light", "Moderate", "UNK", "Heavy", "Severe", "Other"]
            - name: START_TIME_UTC_
              description: The start time of an event in UTC time zone.
              tests:
                - not_null
            - name: END_TIME_UTC_
              description: The end time of an event in UTC time zone.
              tests:
                - not_null
            - name: time_zone
              description: The US-based timezone based on the location of an event (eastern, central, mountain, and pacific).
              tests:
                - not_null
            - name: LOCATION_LAT
              description: The latitude in GPS coordinate.
            - name: LOCATION_LNG
              description: The longitude in GPS coordinate.
            - name: AIRPORT_CODE
              description: The airport station that a weather event is reported from.
            - name: City
              description: The city in address record.
            - name: County
              description: The county in address record.
            - name: State
              description: The state in address record.
            - name: Zip_Code
              description: The zipcode in address record.

    - name: traffic_events
      database: TRAFFIC_WEATHER
      schema: traffic
      tables:
        - name: US_TRAFFIC_EVENTS_RAW
          description: Raw traffic events data in United States
          columns:
            - name: event_id
              description: Primary Key
              tests:
                - unique
                - not_null
            - name: type
              description: The type of an event; examples are accident and congestion.
              tests:
                - accepted_values:
                    values: ['Accident', 'Broken-Vehicle', 'Congestion', 'Construction', 'Event', 'Lane-Blocked', 'Flow-Incident']
                - not_null
            - name: severity
              description: The severity is a value between 0 and 4, where 0 indicates the least impact on traffic (i.e., short delay as a result of the event) and 4 indicates a significant impact on traffic (i.e., long delay).
              tests:
                - accepted_values:
                    values: [0, 1, 2, 3, 4]
                - not_null
            - name: tmc
              description: Each traffic event has a Traffic Message Channel (TMC) code which provides a more detailed description on type of the event.
              tests:
                - not_null
            - name: description
              description: The natural language description of an event.
            - name: START_TIME_UTC_
              description: The start time of an event in UTC time zone.
              tests:
                - not_null
            - name: END_TIME_UTC_
              description: The end time of an event in UTC time zone.
              tests:
                - not_null
            - name: time_zone
              description: The US-based timezone based on the location of an event (eastern, central, mountain, and pacific).
            - name: Location_Lat
              description: The latitude in GPS coordinate.
            - name: Location_Lng
              description: The longitude in GPS coordinate.
            - name: "DISTANCE_MI_"
              description: The length of the road extent affected by the event.
            - name: Airport_Code
              description: The closest airport station to the location of a traffic event.
            - name: Number
              description: The street number in address record.
            - name: Street
              description: The street name in address record.
            - name: side
              description: The relative side of a street (R/L) in address record.
              tests:
                - accepted_values:
                    values: ["R", "L"]
                    config:
                      severity: warn
            - name: City
              description: The city in address record.
            - name: County
              description: The county in address record.
            - name: State
              description: The state in address record.
            - name: ZipCode
              description: The zipcode in address record.


    - name: fivetran_sync
      database: TRAFFIC_WEATHER
      schema: TRAFFIC_WEATHER_PROD
      tables:
        - name: traffic
          description: Raw traffic events data in United States synced with fivetran
        - name: weather
          description: Raw traffic events data in United States synced with fivetran

    - name: openweatherdata
      database: TRAFFIC_WEATHER
      schema: weather
      tables:
        - name: data
          description: Raw data from openweather api, 5 days 3 hours 
